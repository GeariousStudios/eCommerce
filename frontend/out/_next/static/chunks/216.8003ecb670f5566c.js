(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[216],{1151:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(2115);let a=r.forwardRef(function(e,t){let{title:n,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},2175:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(2115);let a=r.forwardRef(function(e,t){let{title:n,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))})},3555:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(5155),a=n(1151),l=n(1972),o=n(4163);let s=e=>(0,r.jsx)(r.Fragment,{children:e.isOpen&&(0,r.jsx)(o.A,{isOpen:e.isOpen,onClose:()=>e.onClose(),icon:a.A,label:"\xc4r du s\xe4ker?",children:(0,r.jsxs)("div",{className:"relative flex gap-8 flex-col",children:[(0,r.jsx)("p",{children:"Ett borttaget objekt g\xe5r ej att f\xe5 tillbaka."}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between",children:[(0,r.jsx)("button",{type:"button",onClick:e.onConfirm,className:"".concat(l.eA," w-full grow-2 sm:w-auto"),children:"Ta bort"}),(0,r.jsx)("button",{type:"button",onClick:e.onClose,className:"".concat(l.p9," w-full grow sm:w-auto"),children:"\xc5ngra"})]})]})})})},6216:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var r=n(5155),a=n(7765),l=n(2175),o=n(1151),s=n(2115),i=n(4402),c=n(5028);n(7548);let d=(0,c.default)(()=>Promise.all([n.e(760),n.e(430)]).then(n.bind(n,4430)),{loadableGenerated:{webpack:()=>[4430]},ssr:!1}),u=(0,s.forwardRef)((e,t)=>{let{value:n,name:a,required:l}=e,o=(0,s.useRef)(null),i=(0,s.useRef)(null);return(0,s.useImperativeHandle)(t,()=>({getContent:()=>{var e,t,n,r;return null!=(r=null==(n=o.current)||null==(t=n.getEditor())||null==(e=t.root)?void 0:e.innerHTML)?r:""},getContentText:()=>{var e,t,n;return null!=(n=null==(t=o.current)||null==(e=t.getEditor())?void 0:e.getText())?n:""},setContent:e=>{var t;let n=null==(t=o.current)?void 0:t.getEditor();n&&n.clipboard.dangerouslyPasteHTML(e,"silent")},getTextarea:()=>i.current})),(0,s.useEffect)(()=>{let e=setInterval(()=>{var t;let r=null==(t=o.current)?void 0:t.getEditor();r&&r.root.innerHTML!==n&&(r.clipboard.dangerouslyPasteHTML(n,"silent"),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),clearInterval(e))},50);return()=>clearInterval(e)},[n]),(0,r.jsxs)("div",{className:"focus-within:z-[calc(var(--z-base)+1) relative w-full rounded border border-(--border-main)] focus-within:outline-2 focus-within:outline-offset-2 focus-within:outline-(--accent-color)]",children:[(0,r.jsx)(d,{ref:o,id:"quill-editor",theme:"snow",placeholder:" ",modules:{toolbar:[["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],["clean"]],keyboard:{bindings:{tab:{key:9,handler:function(){let e=document.querySelector(":focus + *");return!!e&&(e.focus(),!0)}}}}}}),(0,r.jsx)("textarea",{ref:i,tabIndex:-1,autoComplete:"off",onChange:()=>{},name:a,required:l,defaultValue:"",style:{position:"absolute",width:"100%",bottom:"0",pointerEvents:"none",opacity:"0"}})]})});var m=n(1701),h=n(1972),f=n(8500),g=n(4163);let x=e=>{let t=(0,s.useRef)(null),n=(0,s.useRef)(null),[o,c]=(0,s.useState)(""),[d,x]=(0,s.useState)(""),[p,v]=(0,s.useState)(""),[b,j]=(0,s.useState)(""),[w,y]=(0,s.useState)(""),[k,C]=(0,s.useState)(""),[N,S]=(0,s.useState)(!1),A=localStorage.getItem("token"),{notify:L}=(0,f.d)(),E="https://ecommerce-9jo7.onrender.com";(0,s.useEffect)(()=>{N||S(!0)},[]),(0,s.useEffect)(()=>{if(e.isOpen)if(null!==e.newsId&&void 0!==e.newsId)T(e.newsId);else{var n;c(""),x(""),v(""),j(""),null==(n=t.current)||n.setContent("")}},[e.isOpen,e.newsId]);let I=async n=>{var r,a;n.preventDefault();let l=null!=(a=null==(r=t.current)?void 0:r.getContent())?a:"";try{let t=await fetch("".concat(E,"/news/create"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(A)},body:JSON.stringify({date:o,type:d,headline:p,content:l})}),n=await t.json();t.ok?(e.onClose(),e.onNewsUpdated(),L("success","Nyhet skapad!",4e3)):L("error",n.message)}catch(e){L("error",String(e))}},T=async e=>{try{let t=await fetch("".concat(E,"/news/fetch/").concat(e),{headers:{"Content-Type":"application/json"}}),n=await t.json();t.ok?O(n):L("error",n.message)}catch(e){L("error",String(e))}},O=e=>{var t,n,r,a;let l=e.date?new Date(e.date):null;c(l?"".concat(l.getFullYear(),"-").concat(String(l.getMonth()+1).padStart(2,"0"),"-").concat(String(l.getDate()).padStart(2,"0")):""),x(null!=(t=e.type)?t:""),v(null!=(n=e.headline)?n:""),j(null!=(r=e.content)?r:""),y(null!=(a=e.author)?a:""),C(e.authorId)},R=async(n,r)=>{var a,l;n.preventDefault();let s=null!=(l=null==(a=t.current)?void 0:a.getContent())?l:"";try{let t=await fetch("".concat(E,"/news/update/").concat(r),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(A)},body:JSON.stringify({date:o,type:d,headline:p,content:s})}),n=await t.json();if(!t.ok)return void L("error",n.message);e.onClose(),e.onNewsUpdated(),L("success","Nyhet uppdaterad!",4e3)}catch(e){L("error",String(e))}};return(0,r.jsxs)(r.Fragment,{children:[N&&(0,r.jsx)("div",{style:{display:"none"},children:(0,r.jsx)(u,{ref:t,value:"",name:"editor-preload"})}),e.isOpen&&(0,r.jsx)(g.A,{isOpen:e.isOpen,onClose:()=>e.onClose(),icon:e.newsId?l.A:a.A,label:e.newsId?"Redigera nyhet":"L\xe4gg till nyhet",children:(0,r.jsxs)("form",{ref:n,className:"relative flex flex-col gap-8",onSubmit:t=>e.newsId?R(t,e.newsId):I(t),children:[(0,r.jsx)(m.A,{id:"date",type:"date",label:"Datum",value:o,onChange:e=>c(String(e)),onModal:!0,required:!0}),(0,r.jsx)(i.A,{label:"Nyhetstyp",value:d,onChange:x,options:[{value:"Release",label:"Release"},{value:"Hotfix",label:"Hotfix"}],onModal:!0,required:!0}),(0,r.jsx)(m.A,{id:"headline",label:"Rubrik",value:p,onChange:e=>v(String(e)),onModal:!0,required:!0}),(0,r.jsx)(u,{ref:t,value:b,name:"content",required:!0}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{var e,r,a;let l=null!=(a=null==(e=t.current)?void 0:e.getContentText())?a:"",o=null==(r=t.current)?void 0:r.getTextarea();o&&(o.value=""!==l.trim()?"filled":""),setTimeout(()=>{var e;null==(e=n.current)||e.requestSubmit()},0)},className:"".concat(h.$e," w-full sm:w-auto grow-2"),children:e.newsId?"Uppdatera":"L\xe4gg till"}),(0,r.jsx)("button",{type:"button",onClick:e.onClose,className:"".concat(h.p9," w-full sm:w-auto grow"),children:"\xc5ngra"})]})]})})]})};var p=n(3555),v=n(4541),b=n(7877);let j=e=>{let[t,n]=(0,s.useState)([]),[i,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[g,j]=(0,s.useState)(null),[w,y]=(0,s.useState)(!1),[k,C]=(0,s.useState)(""),[N,S]=(0,s.useState)(""),[A,L]=(0,s.useState)(!1),E="https://ecommerce-9jo7.onrender.com",I=localStorage.getItem("token"),{notify:T}=(0,f.d)();(0,s.useEffect)(()=>{let e=localStorage.getItem("postLoginToast");e&&(T("info","V\xe4lkommen, "+e+"!",6e3),localStorage.removeItem("postLoginToast"))},[]);let O=async()=>{try{y(!0);let e=await fetch("".concat(E,"/news/fetch"),{headers:{"Content-Type":"application/json"}}),t=await e.json();e.ok?n(t):T("error",t.message)}catch(e){}finally{y(!1)}},R=async e=>{try{let t=await fetch("".concat(E,"/news/delete/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(I)}}),r=await t.json();t.ok?(n(t=>t.filter(t=>t.id!==e)),T("success","Nyhet borttagen!",4e3)):T("error",r.message)}catch(e){T("error",String(e))}},H=async e=>{if(e.preventDefault(),!A){L(!0),localStorage.removeItem("token");try{let e=await fetch("".concat(E,"/user/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:k,password:N})}),t=await e.json();e.ok?(localStorage.setItem("token",t.token),localStorage.setItem("postLoginToast",t.message),window.location.reload()):(T("error",t.message),L(!1))}catch(e){T("error",String(e)),L(!1)}}};(0,s.useEffect)(()=>{O()},[]);let M=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;j(e),c(!0)},D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&j(e),u(e=>!e)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x,{isOpen:i,onClose:()=>{c(!1)},newsId:g,onNewsUpdated:O}),(0,r.jsx)(p.A,{isOpen:d,onClose:D,onConfirm:()=>{null!==g&&R(g),u(!1)}}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row",children:[!1===e.isLoggedIn&&(0,r.jsxs)("div",{className:"flex w-full flex-col lg:w-1/3 lg:min-w-80",children:[(0,r.jsx)("div",{className:"flex h-[40px] items-center rounded-t border border-(--border-main)] bg-(--bg-grid-header)] px-3 py-2",children:(0,r.jsx)("span",{className:"font-semibold",children:"Logga in"})}),(0,r.jsx)("div",{className:"flex max-h-144 min-h-144 items-center justify-center rounded-b border border-t-0 border-(--border-main)] p-4",children:e.isConnected?(0,r.jsxs)("form",{onSubmit:H,className:"flex w-64 flex-col gap-8",children:[(0,r.jsx)(m.A,{id:"username",type:"text",label:"Anv\xe4ndarnamn",onChange:e=>C(String(e)),required:!0}),(0,r.jsx)(m.A,{id:"password",type:"password",label:"L\xf6senord",onChange:e=>S(String(e)),required:!0}),(0,r.jsx)("button",{type:"submit",className:"".concat(h.$e," w-full"),disabled:A,children:"Logga in"}),(0,r.jsx)("span",{className:"-mt-4 flex justify-center text-center",children:(0,r.jsx)("button",{type:"button",onClick:()=>T("error",{t("Common/Not implemented")}),className:"".concat(h.$U," "),children:"Gl\xf6mt ditt l\xf6senord?"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{children:"Anv\xe4ndarnamn: master"}),(0,r.jsx)("span",{children:"L\xf6senord: master"})]})]}):(0,r.jsx)(b.default,{icon:"server",content:"server"})})]}),(0,r.jsxs)("div",{className:"".concat(e.isLoggedIn?"w-full":"lg:w-2/3"," flex w-full flex-col"),children:[(0,r.jsxs)("div",{className:"flex h-[40px] items-center justify-between rounded-t border border-(--border-main)] bg-(--bg-grid-header)] px-3 py-2",children:[(0,r.jsx)("span",{className:"truncate font-semibold",children:"Nyheter"}),!1!==e.isLoggedIn&&e.isAdmin&&(0,r.jsx)(v.A,{content:"L\xe4gg till nyhet",hideOnClick:!0,children:(0,r.jsx)("button",{type:"button",className:"".concat(h.U0," min-h-6 min-w-6"),onClick:()=>M(null),children:(0,r.jsx)(a.A,{})})})]}),(0,r.jsx)("div",{className:"flex max-h-144 min-h-144 flex-col overflow-y-auto rounded-b border border-t-0 border-(--border-main)] p-2",children:e.isAuthReady?w?(0,r.jsx)(b.default,{icon:"loading",content:"H\xe4mtar nyheter..."}):t.length>0?(0,r.jsx)("div",{children:t.map((n,a)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("article",{className:"group duration-fast flex flex-col p-2 transition-colors hover:bg-(--bg-navbar-link)]",children:[(0,r.jsx)("time",{className:"text-xs uppercase",dateTime:n.date,children:new Date(n.date).toLocaleDateString("sv-SE",{day:"numeric",month:"long",year:"numeric"})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-xl text-(--accent-color)]",children:n.type}),!1!==e.isLoggedIn&&e.isAdmin&&(0,r.jsxs)("div",{className:"mr-2 hidden gap-2 group-hover:flex",children:[(0,r.jsx)(v.A,{content:"Redigera nyhet",hideOnClick:!0,children:(0,r.jsx)("button",{type:"button",className:"".concat(h.U0),onClick:()=>M(n.id),children:(0,r.jsx)(l.A,{})})}),(0,r.jsx)(v.A,{content:"Ta bort nyhet",hideOnClick:!0,children:(0,r.jsx)("button",{type:"button",className:"".concat(h.Xd),onClick:()=>D(n.id),children:(0,r.jsx)(o.A,{})})})]})]}),(0,r.jsx)("h4",{className:"text-lg font-semibold",children:n.headline}),(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:n.content}}),(0,r.jsxs)("small",{className:"text-(--text-secondary) italic",children:["Publicerad av:"," ",e.isAdmin?n.author+" (ID: "+n.authorId+")":n.author]})]}),a!==t.length-1&&(0,r.jsx)("hr",{className:"text-(--border-main)]"})]},a))}):e.isConnected?(0,r.jsx)(b.default,{content:"Det finns tyv\xe4rr inga nyheter f\xf6r tillf\xe4llet!"}):(0,r.jsx)(b.default,{icon:"server",content:"server"}):""})]})]})]})}},7548:()=>{},7765:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(2115);let a=r.forwardRef(function(e,t){let{title:n,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))})}}]);